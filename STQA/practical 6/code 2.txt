package pract6;

import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;

import jxl.Sheet;
import jxl.Workbook;
import jxl.read.biff.BiffException;
import jxl.write.Label;
import jxl.write.WritableSheet;
import jxl.write.WritableWorkbook;
import jxl.write.WriteException;

public class Pract6 {

    public static void main(String[] args) {
        try {
            FileInputStream is = new FileInputStream("D:\\TYCS\\STQA\\examdata1.xls");
            Workbook workbook = Workbook.getWorkbook(is);
            Sheet sheet = workbook.getSheet(0);
            int rows = sheet.getRows();
            int cols = sheet.getColumns();

            FileOutputStream os = new FileOutputStream("D:\\TYCS\\STQA\\result3.xls");
            WritableWorkbook writableWorkbook = Workbook.createWorkbook(os);
            WritableSheet resultSheet = writableWorkbook.createSheet("RESULT", 0);

            int resultRow = 0;

            for (int i = 0; i < rows; i++) {
                // Get marks from 4th column (index 3) â€” skip check for header row
                if (i == 0 || Integer.parseInt(sheet.getCell(3, i).getContents()) >= 60) {
                    for (int j = 0; j < cols; j++) {
                        String cellData = sheet.getCell(j, i).getContents();
                        Label label = new Label(j, resultRow, cellData);
                        resultSheet.addCell(label);
                    }
                    resultRow++; // advance only if row is written
                }
            }

            writableWorkbook.write();
            writableWorkbook.close();
            System.out.println("Result file created with students who scored >= 60.");

        } catch (IOException | BiffException | WriteException e) {
            e.printStackTrace();
        }
    }
}
