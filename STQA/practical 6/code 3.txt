package prac6;

import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;

import jxl.Sheet;
import jxl.Workbook;
import jxl.read.biff.BiffException;
import jxl.write.Label;
import jxl.write.WritableSheet;
import jxl.write.WritableWorkbook;
import jxl.write.WriteException;

public class Prac6 {

    public static void main(String[] args) {
        try {
            FileInputStream input = new FileInputStream("D:\\TYCS\\STQA\\examdata1.xls");
            Workbook workbook = Workbook.getWorkbook(input);
            Sheet sheet = workbook.getSheet(0);

            int rows = sheet.getRows();
            int cols = sheet.getColumns();

            FileOutputStream output = new FileOutputStream("D:\\TYCS\\STQA\\result4.xls");
            WritableWorkbook resultWorkbook = Workbook.createWorkbook(output);
            WritableSheet resultSheet = resultWorkbook.createSheet("Result", 0);

            int resultRow = 0;

            for (int i = 0; i < rows; i++) {
                boolean allAbove60 = true;

                if (i != 0) {
                    for (int j = 2; j < cols; j++) {
                        String value = sheet.getCell(j, i).getContents();
                        int mark = Integer.parseInt(value);
                        if (mark < 60) {
                            allAbove60 = false;
                            break;
                        }
                    }
                }

                if (i == 0 || allAbove60) {
                    for (int j = 0; j < cols; j++) {
                        String data = sheet.getCell(j, i).getContents();
                        Label label = new Label(j, resultRow, data);
                        resultSheet.addCell(label);
                    }
                    resultRow++;
                }
            }

            resultWorkbook.write();
            resultWorkbook.close();

            System.out.println("Result file created with students who scored 60+ in all subjects.");

        } catch (IOException | WriteException | BiffException e) {
            e.printStackTrace();
        }
    }
}
